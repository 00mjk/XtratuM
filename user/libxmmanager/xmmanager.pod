=pod 

=head1 NAME

B<xmmanager> - XtratuM Manager

=head1 SYNOPSIS

B<xmmanager>

=head1 AUTHOR

Salva Peiro <speiro@ai2.upv.es>

=head1 DESCRIPTION

C<xmmanager> is a command-line interpreter which receives input commands
encoding XtratuM hypercalls which are executed the resulting output shown to the user.
C<xmmanager> allows to perform management tasks of the XtratuM hypervisor,
an example of this is being able to monitor and change the state of the system
and partitions, by halting or restarting the running partitions.

I<Command-line abbreviations>:

The C<xmmanager> interpreter accepts abbreviated input commands,
this is supported both at the command and at the sub-command level.
For example a frequent operation like listing the partitions with C<"list">
can be abbreviated to C<"l">, also halting a partition 3 with C<"partition halt 3">
can be abbreviated to C<"p h 3">.

=for comment TBD encontrar una forma/estructura para comentar correctamente

The C<xmmanager> provides several commands that are focused in the
management of a given subsystem.

=over 4

=item * C<help>       Display this help.

The usage is: C<help [command]>
If the C<[command]> part is ommited then a help message for each command is shown.

=item * C<hm>         Manage health monitoring.

The C<hm> command usage is: C<hm [read|seek|status] args>.
Which allows to respectively read, seek or check the status of the XtratuM
Health Monitor logstream.

The information is obtained using the specific C<XM_hm()> hypercalls.

=item * C<list>       List partitions.

The C<list> command usage is: C<list [partitionid]>.
Which allows 1) to list all the partitions in the system if no C<[partitionid> is provided,
or 2) if a specific C<partitionid> is provided list that partition.

The information is obtained using the C<XM_partition_get_status()> hypercall.

=item * C<memarea>    List memory areas.

The C<memarea> command displays the memory areas associated to the current partition.

The information is obtained using the C<XM_get_physmem_map()> hypercall.

=item * C<partition>  Control partition state.

The C<partition> command usage is: C<partition [halt|reset|resume|status|suspend] [partitionid]>.
Which allows to respectively halt, reset, resume, status and suspend a partition with ID C<partitionid>.

The information is obtained using the 
C<XM_halt_partition(), XM_resume_partition(), XM_reset_partition(), XM_suspend_parition()>
hypercalls.

=item * C<port>       Manage communication ports.

The command C<port> usage is: C<port type operation portname portsize [message|nmessage]>.

=item * C<quit>       Exit xmmanager.

The usage is: C<quit>

=item * C<trace>      Manage traces.

The command C<trace> usage is: C<trace [event|open|read|seek|status] traceid>.

=item * C<xdump>         Dump memory contents.

The command C<xdump> usage is: C<xdump [srcpart] [srcaddr] [nbytes]>.

=item * C<xwrite>         Write memory contents.

The command C<xwrite> usage is: C<xwrite [dstpart] [dstaddr] [value]>.

=item * C<xwfile>        Write file contents to memory

The command C<xwfile> usage is: C<xwfile [dstpart] [dstpart [file]>.

=item * C<xm>         Manage hypervisor status.

The command C<xm> usage is: C<xm [status]>.

=item * C<plan>       Manage hypervisor scheduling plan

The command C<plan> usage is: C<plan [id]>.

=back


=head1 USAGE

List the running partitions together with its state:

    xm0> list
    List of Partitions:
    * Partition0: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
      Partition1: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
      Partition2: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
    Status: Done returned 0 "XM_OK"

Halt the second partition (Partition2):

    xm0> partition halt 2
    Status: Done returned 0 "XM_OK"
    xm0> list
    List of Partitions:
    * Partition0: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
      Partition1: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
      Partition2: 0x0 magic 0x0 state 0x3 "XM_STATUS_HALTED"
    Status: Done returned 0 "XM_OK"

Restart the second partition (Partition2):

    xm0> partition reset 2
    Status: Done returned 0 "XM_OK"
    xm0> list
    List of Partitions:
    * Partition0: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
      Partition1: 0x0 magic 0x0 state 0x0 "XM_STATUS_READY"
      Partition2: 0x0 magic 0x0 state 0x3 "XM_STATUS_READY"
    Status: Done returned 0 "XM_OK"

=begin comment

% TBD complete use cases

=end comment
